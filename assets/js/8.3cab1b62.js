(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{246:function(e,a,t){"use strict";t.r(a);var n=t(0),r=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"content"},[t("p",[e._v("js 下载后端返回的文件流")]),e._v(" "),t("h2",{attrs:{id:"axios-请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#axios-请求","aria-hidden":"true"}},[e._v("#")]),e._v(" axios 请求")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('export const doExportExcel = params => {\n  return axios({\n    responseType: "blob", // arraybuffer  必须显式指明响应类型是一个Blob对象，这样生成二进制的数据，能通过window.URL.createObjectURL进行创建成功,解决下载文件空白或出错问题,二进制文件一般设置为blob即可,\n    method: "get",\n    url: \'/main/doExportExcel\',\n    params\n  });\n};\n')])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('async proOut() {\n      let timestamp = new Date().getTime();\n      const data = await doExportExcel();\n      // 组装a标签\n      let elink = document.createElement("a");\n      // 设置下载文件名\n      elink.download = timestamp + ".xlsx";\n      elink.style.display = "none";\n      let blob = new Blob([data]);\n      elink.href = URL.createObjectURL(blob);\n      document.body.appendChild(elink);\n      elink.click();\n      document.body.removeChild(elink);\n    }\n')])])]),t("blockquote",[t("p",[e._v("注意: mock 模块会影响原生的 ajax 请求，使得服务器返回的 blob 类型变成乱码")])]),e._v(" "),t("h2",{attrs:{id:"window-location"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#window-location","aria-hidden":"true"}},[e._v("#")]),e._v(" window.location")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("let url = `${baseUrl}/main/doExportExcel`;\nwindow.location=url;\n")])])]),t("h2",{attrs:{id:"直接使用-form-表单的提交，不使用-js-的-get-请求-提交后就直接下载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#直接使用-form-表单的提交，不使用-js-的-get-请求-提交后就直接下载","aria-hidden":"true"}},[e._v("#")]),e._v(" 直接使用 form 表单的提交，不使用 js 的 get 请求,提交后就直接下载")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("function DownLoad(url , data) {\n var $iframe = $('<iframe />');\n  var $form = $('<form  method=\"get\" target=\"_self\"/>');\n  $form.attr('action', url);\n  for (var key in data) {\n    $form.append('<input type=\"hidden\"  name=\"' + key  + '\" value=\"' + data[key] + '\" />');\n   }\n  $iframe.append($form);\n  $(document.body).append($iframe);\n  $form[0].submit();\n  $iframe.remove();\n}\n")])])])])}],!1,null,null,null);r.options.__file="js下载后端返回的文件流.md";a.default=r.exports}}]);